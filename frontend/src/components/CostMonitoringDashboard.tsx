import React, { useState, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { \n  DollarSign, \n  TrendingDown, \n  TrendingUp, \n  Shield, \n  Zap, \n  AlertTriangle,\n  CheckCircle\n} from 'lucide-react';\n\ninterface CostMetrics {\n  totalProcessed: number;\n  duplicatesBlocked: number;\n  costSaved: number;\n  qualityChecksBlocked: number;\n  monthlySpend: number;\n  monthlyBudget: number;\n  avgConfidence: number;\n  processingTime: number;\n}\n\nconst CostMonitoringDashboard: React.FC = () => {\n  const [metrics, setMetrics] = useState<CostMetrics>({\n    totalProcessed: 0,\n    duplicatesBlocked: 0,\n    costSaved: 0,\n    qualityChecksBlocked: 0,\n    monthlySpend: 0,\n    monthlyBudget: 500, // â‚¹500 monthly budget\n    avgConfidence: 0,\n    processingTime: 0\n  });\n\n  const [optimizations, setOptimizations] = useState([\n    {\n      type: 'duplicate_detection',\n      description: 'Duplicate detection prevents reprocessing',\n      savings: 0,\n      status: 'active'\n    },\n    {\n      type: 'quality_check',\n      description: 'Image quality validation saves failed requests',\n      savings: 0,\n      status: 'active'\n    },\n    {\n      type: 'confidence_threshold',\n      description: 'Dynamic confidence thresholds improve accuracy',\n      savings: 0,\n      status: 'active'\n    },\n    {\n      type: 'batch_limiting',\n      description: 'Concurrent request limiting prevents rate limit errors',\n      savings: 0,\n      status: 'active'\n    }\n  ]);\n\n  useEffect(() => {\n    // Load metrics from localStorage or API\n    const savedMetrics = localStorage.getItem('aiCostMetrics');\n    if (savedMetrics) {\n      setMetrics(JSON.parse(savedMetrics));\n    }\n  }, []);\n\n  const budgetUsagePercent = (metrics.monthlySpend / metrics.monthlyBudget) * 100;\n  const totalSavings = metrics.costSaved;\n  const efficiencyScore = metrics.duplicatesBlocked > 0 \n    ? ((metrics.duplicatesBlocked / (metrics.totalProcessed + metrics.duplicatesBlocked)) * 100)\n    : 0;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-2xl font-bold flex items-center gap-2\">\n          <Shield className=\"h-6 w-6 text-green-600\" />\n          AI Cost Optimization Dashboard\n        </h2>\n        <Badge variant=\"outline\" className=\"bg-green-50 text-green-700\">\n          â‚¹{totalSavings.toFixed(2)} saved this month\n        </Badge>\n      </div>\n\n      {/* Budget Overview */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <DollarSign className=\"h-4 w-4\" />\n              Monthly Spend\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">â‚¹{metrics.monthlySpend.toFixed(2)}</div>\n            <div className=\"text-xs text-muted-foreground\">\n              of â‚¹{metrics.monthlyBudget} budget\n            </div>\n            <Progress value={budgetUsagePercent} className=\"mt-2 h-2\" />\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <TrendingDown className=\"h-4 w-4 text-green-600\" />\n              Cost Saved\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold text-green-600\">â‚¹{totalSavings.toFixed(2)}</div>\n            <div className=\"text-xs text-muted-foreground\">\n              Through optimizations\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <Shield className=\"h-4 w-4\" />\n              Efficiency Score\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{efficiencyScore.toFixed(1)}%</div>\n            <div className=\"text-xs text-muted-foreground\">\n              Duplicates prevented\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium flex items-center gap-2\">\n              <Zap className=\"h-4 w-4\" />\n              Avg Confidence\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{(metrics.avgConfidence * 100).toFixed(1)}%</div>\n            <div className=\"text-xs text-muted-foreground\">\n              Processing accuracy\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Optimization Status */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <CheckCircle className=\"h-5 w-5 text-green-600\" />\n            Active Optimizations\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {optimizations.map((opt, index) => (\n              <div key={index} className=\"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200\">\n                <div className=\"flex items-center gap-3\">\n                  <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                  <div>\n                    <p className=\"font-medium text-sm\">{opt.description}</p>\n                    <p className=\"text-xs text-muted-foreground capitalize\">{opt.type.replace('_', ' ')}</p>\n                  </div>\n                </div>\n                <Badge variant=\"outline\" className=\"bg-green-100 text-green-700\">\n                  Active\n                </Badge>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Processing Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Processing Statistics</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm\">Total Documents Processed</span>\n              <span className=\"font-medium\">{metrics.totalProcessed}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm\">Duplicates Blocked</span>\n              <span className=\"font-medium text-green-600\">{metrics.duplicatesBlocked}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm\">Quality Checks Failed</span>\n              <span className=\"font-medium text-orange-600\">{metrics.qualityChecksBlocked}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm\">Avg Processing Time</span>\n              <span className=\"font-medium\">{metrics.processingTime.toFixed(1)}s</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Cost Breakdown</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm\">GPT-4 Vision Calls</span>\n              <span className=\"font-medium\">â‚¹{(metrics.monthlySpend * 0.7).toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm\">Whisper Transcriptions</span>\n              <span className=\"font-medium\">â‚¹{(metrics.monthlySpend * 0.2).toFixed(2)}</span>\n            </div>\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm\">Text-to-Speech</span>\n              <span className=\"font-medium\">â‚¹{(metrics.monthlySpend * 0.1).toFixed(2)}</span>\n            </div>\n            <div className=\"border-t pt-2\">\n              <div className=\"flex justify-between items-center font-medium\">\n                <span>Total Monthly Cost</span>\n                <span>â‚¹{metrics.monthlySpend.toFixed(2)}</span>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Budget Alert */}\n      {budgetUsagePercent > 80 && (\n        <Alert>\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertDescription>\n            <strong>Budget Alert:</strong> You've used {budgetUsagePercent.toFixed(1)}% of your monthly AI budget. \n            Consider reviewing usage or increasing the budget limit.\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Recommendations */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Optimization Recommendations</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            <div className=\"p-3 bg-blue-50 rounded-lg border border-blue-200\">\n              <p className=\"text-sm font-medium text-blue-900\">âœ… All optimizations active</p>\n              <p className=\"text-xs text-blue-700 mt-1\">\n                Your system is running with all cost-saving optimizations enabled. \n                Estimated monthly savings: â‚¹{totalSavings.toFixed(2)}\n              </p>\n            </div>\n            \n            {budgetUsagePercent < 50 && (\n              <div className=\"p-3 bg-green-50 rounded-lg border border-green-200\">\n                <p className=\"text-sm font-medium text-green-900\">ðŸ’¡ Consider increasing processing volume</p>\n                <p className=\"text-xs text-green-700 mt-1\">\n                  You're well within budget. You could process more documents or enable additional AI features.\n                </p>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default CostMonitoringDashboard;"